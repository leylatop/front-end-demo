<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <button id="replay">播放录像</button>
  <script>
    const closeDoorCommand = {
      execute: () => console.log('关门')
    }
    const openPcCommand = {
      execute: () => console.log('开电脑')
    }
    const openQQCommand = {
      execute: () => console.log('登录qq')
    }

    // 宏命令，存储一组命令
    // 1. 使用字面量方式创建函数，用做构造函数的时候，必须使用function创建
    // 2. 且内部的属性方法也必须是普通function，不能是箭头函数
    // const MacroCommand = function() {
    //   return {
    //     commandList: [],
    //     add: function(command){
    //       this.commandList.push(command)
    //     },
    //     execute: function() {
    //       for (let i = 0, command; command = this.commandList[i++];) {
    //         command.execute()
    //       }
    //     }
    //   }
    // }

    class MacroCommand {
      commandList = []
      add = (command) => {
        this.commandList.push(command)
      }
      execute = () => {
        for (let i = 0, command; command = this.commandList[i++];) {
          command.execute()
        }
      }
    }

    const macroCommand = new MacroCommand()
    macroCommand.add(closeDoorCommand)
    macroCommand.add(openPcCommand)
    macroCommand.add(openQQCommand)

    setTimeout(() => {
      macroCommand.execute()
    }, 2000)
  </script>
</body>
</html>